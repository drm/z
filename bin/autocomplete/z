#  file :
#  . /etc/bash_completion.d/z      
#
#  Completion for z:
#
#  z option [arg]
#

_z()
{
    # local vars
    local cur prev opts envs
    # COMPREPLY
    # An array variable from which Bash reads the possible completions
    # generated by a shell function invoked by the programmable completion facility
    #
    COMPREPLY=()
    #
    # We can also see how we found the current word using the array COMP_WORDS to
    # find both the current and the previous word by looking them up:
    #
    # COMP_WORDS
    # An array variable consisting of the individual words in the current command line.
    # This variable is available only in shell functions invoked by the programmable completion facilities.
    #
    # COMP_CWORD
    # An index into ${COMP_WORDS} of the word containing the current cursor position.
    # This variable is available only in shell functions invoked by the programmable completion facilities
    #
    cur="${COMP_WORDS[COMP_CWORD]}"
    prev="${COMP_WORDS[COMP_CWORD-1]}"

    # Default options
    opts=$(echo '' | /usr/bin/php $PWD/helper.php)

    case "${prev}" in
        simulate|deploy)           
            envs=$(echo '' | /usr/bin/php $PWD/helper.php --get=env)
            # Add to COMPREPLY array
            COMPREPLY=( $(compgen -W "${envs}" -- "${cur}") )
            return 0
            ;;
	*)
            COMPREPLY=( $(compgen -W "${opts}" -- "${cur}") )
            return 0
	;;
    esac

}
# Set autocomplete
complete -F _z z
