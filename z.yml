plugins: ['core', 'svn', 'env', 'ci']

tasks:
    docs: cd res/doc && z docs $(z.opts)

    publish:
        pre: @docs
        do: rsync -rv res/doc/html/ zichter@dev3:/var/www/dev/z/default/public/

    qa:
        - phpunit                     $(force ? " || true")
        - phpcs --standard=Zicht src  $(force ? " || true")
        - cd res && behat -f progress $(force ? " || true")

    coverage: phpunit --coverage-html=./tmp/ && firefox ./tmp/index.html

    build: php bin/package.php --force build z

    ci.build:
        post: cd res && behat

    ci.phpunit:
        pre: composer install --dev
